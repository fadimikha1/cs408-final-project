<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Final project-Grocery</title>
  <nav class="nav-links">
    <div><a href="index.html">Grocery List(home)  </a></div>
    <div><a href="prev.html">Previous Weeks.</a></div>
    <div><a href="current.html">Current   </a></div>
  </nav>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

  <h1>Welcome To Grocery List 1.0!</h1>
  <p>To get started, click on the Load database button below that 
    will load all of your grocery items(do this any time you make a
     change like adding or deleting items)</p>

  
  <!-- where the placeholders for the laod items table go -->
  <h3>Load Items</h3>
  <button id="load-data">Load</button>

  <h3>Items:</h3>
  <table id="items-table" border="1">
    <thead>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Price</th>
      </tr>
    </thead>
    <tbody>
      <!-- rows will be added here whenever the load button is presed-->
    </tbody>
  </table>

<!-- this is where the table inputs go -->
  <h3>Add Item</h3>
  <input id="item-id" placeholder="ID">
  <input id="item-name" placeholder="Name">
  <input id="item-price" placeholder="Price" type="number">
  <button id="send-data">Add Item</button>

  <h3>Items:</h3>
  <div id="lambda-info"></div>

  <h3>Delete Item</h3>
  <input id="delete-id" placeholder="ID to delete">
  <button id="delete-data">Delete</button>





  <!-- used a chatgpt prompt to get and fix the load items propery-- -->
  <script>
    const API_BASE = "https://5i8n20gql2.execute-api.us-east-2.amazonaws.com/items";

    document.getElementById("send-data").onclick = function () {
      const id = document.getElementById("item-id").value;
      const name = document.getElementById("item-name").value;
      const price = parseFloat(document.getElementById("item-price").value);

      //gets the data from aws
      fetch(API_BASE, {
        method: "PUT",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ id, name, price })
      })
      
    };

    <!--https://stackoverflow.com/questions/52997839/append-data-to-html-table -- -->

    document.getElementById("load-data").onclick = function () {
  fetch(API_BASE)
    .then(res => res.json())
    .then(items => {
      const tableBody = document.querySelector("#items-table tbody");
      tableBody.innerHTML = ""; // clear previous rows

      //creates the table rows and cells
      items.forEach(item => {
        const row = document.createElement("tr");

        const idCell = document.createElement("td");
        idCell.textContent = item.id;

        const nameCell = document.createElement("td");
        nameCell.textContent = item.name;

        const priceCell = document.createElement("td");
        priceCell.textContent = `$${item.price}`;

        row.appendChild(idCell);
        row.appendChild(nameCell);
        row.appendChild(priceCell);

        tableBody.appendChild(row);
      });
    })

};


    // Partly generated by chatgpt to create teh entry for the id, as it was not working prior -- -->
    document.getElementById("delete-data").onclick = function () {
      const id = document.getElementById("delete-id").value;

      //deletes the data from aws depending on what u put for the id
      fetch(`${API_BASE}/${id}`, {
        method: "DELETE",
      })
      .then(res => res.text()) 
    };
  </script>
</body>
</html>
